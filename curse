#!/usr/bin/env ruby

# CURSES
# Pulls a random curse word out of a curses dictionary and displays it on the
# screen

require "optparse"

# Some setting defaults:
@source_name = "curses_standard.dict"
@infinite = false
@talk = false

optparse = OptionParser.new do |opts|
  opts.banner = "Curses! Command-Line Swear Words\nUsage: curse [options]"
  opts.on("-u", "--unabridged", "Use unabridged swear dictionary") { @source_name = "curses_unabridged.dict" }
  opts.on("-f", "--forever", "Continually output curses in a stream") { @infinite = true }
  opts.on("-s", "--talk", "Speak the curses as they are output") { @talk = true }
  opts.on("-h", "--help", "Display this usage screen") do
    puts opts
    exit 0
  end
end
optparse.parse!

# Prepare our curse dictionary:
@source = File.join(File.dirname(__FILE__), @source_name)
File.open(@source, 'r') {|file| @dict = file.readlines }

begin
  curse = @dict[ rand(@dict.length) ].strip
  print "#{curse} "
  $stdout.flush
  `say "#{curse}"` if @talk
  sleep 1 if @infinite
end while @infinite
puts 
